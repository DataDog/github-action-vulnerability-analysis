# `Vulnerability Analysis` Github Action

The Snyk integration allows Datadog Continuous Profiler to report on vulnerabilities in your code. The Vulnerability 
Analysis (Common Vulnerabilities and Exposures) is performed using [Snyk's Intel Vulnerability DB](https://snyk.io/product/vulnerability-database/).

## Table of Contents

* [Requirements](#requirements)
* [Usage](#usage)
* [Inputs](#inputs)

## Requirements

* A Free Snyk account is required to create the Snyk token. Sign up for a free [Snyk account](https://snyk.io/signup?utm_medium=Partner&utm_source=Datadog&utm_campaign=Datadog-Profiler-2020)
* The Snyk integration is only available for Datadog Continuous Profiler customers.

## Usage

One action must be added for each service to run the Vulnerability Analysis on.

```yaml
jobs:
  vulnerability_analysis:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v2
    - name: Setup Node
      uses: actions/setup-node@v1
      with:
        node-version: 12.x
    - uses: datadog/github-action-vulnerability-analysis@master
      with:
        build-file: 'app/build.gradle'
        service: 'app-name'
        version: 'v2.1'
        datadog-api-key: ${{ secrets.DATADOG_API_KEY }}
        datadog-app-key: ${{ secrets.DATADOG_APP_KEY }}
        snyk-token: ${{ secrets.SNYK_TOKEN }}
```

## Inputs

| Name              | Requirement | Default | Description |
| ----------------- | ----------- | ------- | ----------- |
| `file`            | _required_  |         | The build file of the service. Example: `app/build.gradle` or `app/pom.xml`|
| `service`         | _required_  |         | The service name. Example: `app-name`|
| `version`         | _required_  |         | The version of the application. Example: `v2.1`|
| `datadog-api-key` | _required_  |         | The Datadog API key. A 32-character hexadecimal string. This key is created by your [Datadog organization](https://docs.datadoghq.com/account_management/api-app-keys/) and should be stored as a [secret](https://help.github.com/en/actions/automating-your-workflow-with-github-actions/creating-and-using-encrypted-secrets).|
| `datadog-app-key` | _required_  |         | The Datadog APP key. A 40-character hexadecimal string. This key is created by your [Datadog organization](https://docs.datadoghq.com/account_management/api-app-keys/) and should be stored as a [secret](https://help.github.com/en/actions/automating-your-workflow-with-github-actions/creating-and-using-encrypted-secrets).|
| `snyk-token`      | _required_  |         | The Snyk token. Ex: `a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6`.  This key is created from your [Snyk account](https://support.snyk.io/hc/en-us/articles/360004008258-Authenticate-the-CLI-with-your-account#UUID-4f46843c-174d-f448-cadf-893cfd7dd858_section-idm4557419555668831541902780562) and should be stored as a [secret](https://help.github.com/en/actions/automating-your-workflow-with-github-actions/creating-and-using-encrypted-secrets).|
| `site`            | _optional_  |`datadoghq.com`| The Datadog site. Needs to be set to `datadoghq.eu` for Datadog EU users. Ex: `datadoghq.com` or `datadoghq.eu`|


The Snyk integration only applies to Java applications, with support for more languages coming soon.

The Snyk integration is only available for Datadog Continuous Profiler customers.

The `service` and `version` must follow the same conventions as in [unified service tagging](https://docs.datadoghq.com/getting_started/tagging/unified_service_tagging/?tab=kubernetes)
